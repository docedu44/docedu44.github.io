---
id: docker-react
title: docker-nginx-react
author: mamadfar
---

### Dockerfile

ุจุฑุง ุดุฑูุน ุงุจุชุฏุง ุจุงุฏ ฺฉ **Dockerfile** ( ุฏููุง ุจุง ููู ูุงู ) ุฏุฑ ูููุฏุฑ ุงุตู ูพุฑูฺู ุจุณุงุฒู ู ฺฉุฏ ูุง ุฒุฑ ุฑุง ุฏุฑ ุขู ุงุณุชูุงุฏู ฺฉูู:

<div dir="ltr">

```docker
    FROM node:14.17.3-alpine3.14
    WORKDIR /hami-dashboard
    ENV PATH="./node_modules/.bin:$PATH"
    COPY . ./
    RUN npm install
    RUN npm run build
    RUN npm rebuild node-sass
    CMD ["npm", "start"]
    EXPOSE 3010
```

</div>

`FROM`: ุจุณุชู ุจู ูุฑฺู ุงุณุชูุงุฏู ุดุฏู **node** ุฏุฑ ููฺฏุงู ุณุงุฎุช ูพุฑูฺูุ ูุฑฺู ุขู ุฑุง ููุงุจู **FROM** ู ููุณู ( ุญุชูุง ูุจู ุงุฒ ุขู ุจุงุฏ ุฏุฑ ุณุงุช **hub.docker.com** ฺฺฉ ฺฉูู ฺฉ ูุฑฺู ููุดุชู ุดุฏูุ ููุฌูุฏ ุจุงุดุฏ ).

`WORKDIR`: ูุณุฑ ูููุฏุฑ ุงุตู ูพุฑูฺู ู ุจุงุดุฏ ฺฉ **Dockerfile** ุฏุฑ ุขู ู ุจุงุดุฏ.

`ENV PATH`: ูุณุฑ ูุงฺูู ูุง ุงุณุชูุงุฏู ุดุฏู ู ุจุงุดุฏ ฺฉ ุจุฑุง **JS** ุจุงุฏ ูุณุฑ **node_modules** ุฏุงุฏู ุดูุฏ.

`COPY`: ุขุฑฺฏููุงู ุงูู ูุณุฑ ู ูุงู ูุงู ููุฑุฏ ูุธุฑ ู ุจุงุดุฏ ู ุขุฑฺฏููุงู ุฏูู ูุณุฑ ูููุฏุฑ ููุฑุฏ ูุธุฑ ุฏุฑ ุฏุงฺฉุฑ ู ุจุงุดุฏ ( ูุงู ูุง ฺฉูพ ู ุดููุฏ ู ุฏุฑ ุฏุงฺฉุฑ ุงูุตุงู ู ุดููุฏ ). ุฏุฑ ูุงูุน ููุทู ุฏูู ููุงู **WORKDIR** ู ุจุงุดุฏ.

`RUN`: ุฏุณุชูุฑ ูุง ููุฑุฏ ูุงุฒ ุฑุง ุฏุฑ ุงู ูุณูุช ูุฑุงุฑ ู ุฏูู ุชุง ุจุนุฏ ุงุฒ ฺฉูพ ุดุฏูุ ุงุฌุฑุง ุดููุฏ.

`CMD`: ุขุฎุฑู ุฏุณุชูุฑ ููุฑุฏ ูุงุฒ ุจุฑุง ุงุฌุฑุง ุดุฏู ุจุฑูุงูู ู ุจุงุดุฏ ฺฉ ุจุงุฏ ุขุฑุงู ุง ุงุฒ ฺฉููุงุช ( ูุซูุง ุฏุณุชูุฑ ุจุงูุง ูููุน ุงุฌุฑุง ุดุฏู ุจู **npm start** ุชุจุฏู ู ุดูุฏ ).

`EXPOSE`: ูพูุฑุช ููุฑุฏ ูุธุฑ ุจุฑุง ุงุฌุฑุง ุดุฏู ุจุฑูุงูู ุฑุง ูุดุฎุต ู ฺฉูู.

๐ ุญุงู ุชูุณุท ุฏุณุชูุฑ ุฒุฑ ู ุชูุงู **Dockerfile** ุฑุง ุงุฌุฑุง ฺฉูู:

<div dir="ltr">

```cmd
    docker build --tag hami-dashboard .
```

</div>

ฺฉู **tag** ูุงู **image** ุณุงุฎุชู ุดุฏู ุฑุง ุชุนู ู ฺฉูุฏ ู ููุทู ( . ) ูุณุฑ ุณุงุฎุช **image** ู ุจุงุดุฏ.

## ุณุงุฎุช ฺฉุงูุชูุฑ

ุญุงู ุชูุณุท ุฏุณุชูุฑ ุฒุฑ **container** ููุฑุฏ ูุธุฑ ุฑุง ุจุฑ ุงุณุงุณ **image** ุณุงุฎุชู ุดุฏู ู ุณุงุฒู ู ุงุฌุฑุง ู ฺฉูู:

<div dir="ltr">

```cmd
    docker run --name hami-dashboard -p 3010:3000 -d hami-dashboard
```

</div>

`name`: ฺฉู ุงุณู ุจุนุฏ ุงุฒ ูพุฑฺู **name** ุฏุฑ ูุงูุน ูุงู **container** ูุง ู ุจุงุดุฏ ู ู ุชูุงูุฏ ูุงู ูุชูุงูุช ุงุฒ ูุงู **image** ุจุงุดุฏ

`-p`: ( ูุฎูู publish ู ุจุงุดุฏ ) ุฏุฑ ูุงูุน ูุดุงูฺฏุฑ ู ุชุนู ฺฉููุฏู **port** ู ุจุงุดุฏ ู 2 ุขุฑฺฏููุงู ุฏุงุฑุฏ ฺฉ ุขุฑฺฏููุงู ุงูู **port** ุฏูุฎูุงู ูุง ู ุจุงุดุฏ ฺฉ ู ุฎูุงูู **app** ุฑุง ุจุง ุขู ูพูุฑุช ุจุจูู ู ุฏูู ูพูุฑุช ุงุตู **app** ูุง ู ุจุงุดุฏ ฺฉ **react** ุจู ุตูุฑุช ูพุด ูุฑุถ ุงุฒ ูพูุฑุช **3000** ุงุณุชูุงุฏู ู ฺฉูุฏ.

`-d`: ูุดุงูฺฏุฑ **detach** ุดุฏู ู ุจุงุดุฏ ุนู ุงฺฏุฑ ุจุฎูุงูู ุจุนุฏ ุงุฒ ุณุงุฎุช **container**ุ ุจุฎูุงูู ุจู ฺฉุงุฑูุงู ุงุฏุงูู ุฏูู ุงุฒ ุงู ูพุฑฺู ุงุณุชูุงุฏู ู ฺฉูู.

ู ุจุนุฏ ุงุฒ **-d** ูุงู **image** ุณุงุฎุชู ุดุฏู ุฑุง ุจุงุฏ ุฏุฑุณุช ูุงุฑุฏ ฺฉูู.

## docker-compose

ุจุฑุง ุจูุชุฑ ฺฉุฑุฏู ุงุฌุฑุง ุดุฏู **dockerFile** ู ูู ฺูู ุงุฌุฑุง ฺูุฏ **Service** ู ฺูุฏ **app** ููุฒูุงู ุจุง ูู ุงุฒ **docker-compose** ุงุณุชูุงุฏู ู ฺฉูู ู ููฺูู ุจู ูุง ุงู ุงูฺฉุงู ุฑุง ู ุฏูุฏ ฺฉู **image** ูุงูุงู ุฑุง ุฑุงุญุช ุชุฑ ุงูุชูุงู ุฏูู

ฺฉู ุจุฑุง **react** ู ุชูุงู ุงุฒ ฺฉุฏ ุฒุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ:

<div dir="ltr">

```docker
    version: "3.9"
    services:
        hdreact:
            build:
                context: .
            volumes:
                - .:/hami-dashboard
            ports:
                - 3010:3000
            image: hdreact:react
            container_name: hami-dashboard
            stdin_open: true
            # command: npm start
            restart: unless-stopped
            # networks:
            # - app-network
```

</div>

`version`: ุฏุฑ ูุงูุน ูุฑฺู ุฎูุฏ **docker-compose** ู ุจุงุดุฏ.

`services`: ูุณุช ุณุฑูุณ ูุง ูุง ู ุจุงุดูุฏ ฺฉู ูุฑ ุณุฑูุณ ุจุงุฏ ฺฉ ูุงู ุฏุงุดุชู ุจุงุดุฏ.

`hdreact`: ูุงู **service** ูุง ู ุจุงุดุฏ ฺฉู ุชูุงู ููุงุฑุฏ ูุฑุจูุท ุจู ุงู ุณุฑูุณ ุจุงุฏ ุฒุฑ ุขู ุจุง ูุงุตูู ูุฑุงุฑ ุจฺฏุฑุฏ.( ูุงู ุฏูุฎูุงู ู ุจุงุดุฏ. )

`build`: ูุณุฑ ู ูุงู **dockerFile** ุฎูุฏ ุฑุง ูุฑุงุฑ ู ุฏูู ฺฉู ุฏุฑ ุงูุฌุง ุจุฑุง ูุณุฑุฏู ุงุฒ `context` ุงุณุชูุงุฏู ู ฺฉูู ู ุขุฏุฑุณ **dockerFile** ุฑุง ู ุฏูู.

`volumes`: ูุณุฑ ูุงู ูุง ฺฉู ู ุฎูุงูู ุจู ุตูุฑุช ุฏุงูุงูฺฉ ุชุบุฑุงุช ุฑุง ุงุนูุงู ฺฉููุฏุ ูุดุฎุต ู ฺฉูู. ุนู ุฏุฑ ฺฉุฏ ูุง ุฏุงุฎู ุณุณุชู ูุฑ ุชุบุฑ ุงุฌุงุฏ ุดูุฏุ ุฏุฑ ุฏุงฺฉุฑ ูุฒ ุชุบุฑ ุงุนูุงู ุดูุฏ. ( ุฏุฑ ุงูุฌุง ฺฉู ูุงู ูพุฑูฺู ู ุจุงุดุฏ )

`ports`: ู ุชูุงู ุจุฑุง ูุฑ ูพูุฑุช **app** ูุงู ฺฉ ูพูุฑุช ุฌุงฺฏุฒู ูุฑุงุฑ ุฏูู ุชุง ุฏุฑ ุฏุงฺฉุฑ ุจุง ฺฉ ูพูุฑุช ุฏฺฏุฑ ุงุฌุฑุง ุดูุฏ.( ุณูุช ฺูพ ูพูุฑุช ุฏูุฎูุงููุงู ฺฉู ู ุฎูุงูู ุงุดุบุงู ุดูุฏ ู ุณูุช ุฑุงุณุช ูพูุฑุช **app** ูุงู ู ุจุงุดุฏ ฺฉู ุฏุงุฎู ุฏุงฺฉุฑ ุงุฌุฑุง ู ุดูุฏุ ุนู ูพูุฑุช **3000** ุฑุง ุจู **3010** ุนูุถ ฺฉู. )

`image`: ฺฉ ูุงู ุฏูุฎูุงู ุจุฑุง **image** ูุงู ู ุจุงุดุฏ ฺฉู ุจูุชุฑ ุงุณุช ูู ูุงู **service** ูุงู ุจุงุดุฏ.( ฺฉู ุงูู ูุงู **image** ู ุฏูู **tag** ุขู ู ุจุงุดุฏ )

`container_name`: ฺฉ ูุงู ุฏูุฎูุงู ุจุฑุง ฺฉุงูุชูุฑ ูุงู ู ุจุงุดุฏ.

`stdin_open`: ูุฑุจูุท ุจู **react** ู ุจุงุดุฏ ฺฉู ุจุง ูุฑ ุชุบุฑ ุณุฑุน ุตูุญู ุฑูุฑุด ุดูุฏ.

`command`: ุจู ุฌุง `CMD` ุฏุฑ **dockerFile**ุ ู ุชูุงู ุฏุฑ **docker-compose** ูู ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉุฑุฏ.

`restart`: ุชูุณุท ุงู ุฏุณุชูุฑุ ฺฉุงูุชูุฑ ฺฉู ุงุณุชุงูพ ู ุดูุฏุ ุฏูุจุงุฑู **restart** ู ุดูุฏุ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ.

`networks`: ุชูุณุท ุงู ุฏุณุชูุฑ ู ุชูุงู **service** ูุง ูุฎุชูู ุฑุง ุฏุฑ ฺฉ ฺฉุงูุชูุฑ ุจุง **network** ูุง ูุฎุชูู ุงุณุชูุงุฏู ฺฉุฑุฏุ ุจุฑุง ูุซุงู ู ุชูุงู ุฏุฑ 2 ูุชูุฑฺฉ ูุฎุชูู ุฏุฑ ฺฉ ฺฉุงูุชูุฑ ุงุฒ ฺฉ **port** ุงุณุชูุงุฏู ฺฉุฑุฏ ( ูุซูุง 80 ) ู ฺูู **network** ูุง ุจุง ูู ูุชูุงูุช ูุณุชูุฏ ูุฑ 2 ูพูุฑุช ฺฉุงุฑ ูฺฉููุฏ.

๐ ูุงุตูู ูุง ุฏุฑ **docker-compose** ุจุณุงุฑ ููู ู ุจุงุดุฏ.

ุญุงู ุชูุณุท ุฏุณุชูุฑ ุฒุฑ ู ุชูุงู ูพุฑูฺู ุฑุง **build** ู ฺฉูู ู ููุฒูุงู ุงุฌุฑุง ูุฒ ู ุดูุฏ:

<div dir="ltr">

```cmd
    docker-compose up -d
```

</div>

## ููุงุฑุฏ ุงุถุงูู

๐ ุชูุณุท ุฏุณุชูุฑ ุฒุฑ ู ุชูุงู ูุณุช **image** ูุง ุฑุง ุฏุฏ:

<div dir="ltr">

```cmd
    docker images
```

</div>

๐ ูุชูุงู ุจุฑุง ฺฉูพ ูฺฉุฑุฏู ูุงู ูุง ู ูููุฏุฑ ูุง ฺฉ ูุงุฒ ูุฏุงุฑู ฺฉ ูุงู **dockerignore.** ุจุณุงุฒู ู ูุงููุฏ ฺฉุฏ ุฒุฑ ูุงู ูุงู ูุง ู ูููุฏุฑ ูุง ุบุฑ ุถุฑูุฑ ุฑุง ุจููุณู:

<div dir="ltr">

```
    node_modules
    Dockerfile
    Dockerfile.prod
    .git
    .dockerignore
    .gitignore
    .env
    *.tar
```

</div>

๐ ู ุชูุงู ุชูุณุท ุฏุณุชูุฑ ุฒุฑ ( ููฺฏุงู ฺฉู **image** ุฏุงุฑู) ุฏูุจุงุฑู ูพุฑูฺู ุฑุง **rebuild** ฺฉูู:

<div dir="ltr">

```docker
    docker-compose up -d --force-recreate --build
```

</div>

ููู: ููุดู ุณุน ุดูุฏ ุงูู package.json ุฑุง ฺฉูพ ู ุณูพุณ ูุตุจ ฺฉูู ( ุฏุฑ ุฏุงฺฉุฑูุงู )ุ ุฒุฑุง ูุง ุฎู ฺฉู ูุงู package.json ุฑุง ุชุบุฑ ู ุฏูู ู ุงฺฏุฑ ุขู ุฑุง ุจู ุฏุงฺฉุฑ ูุงู ุงุถุงูู ูฺฉููุ ูุฑ ุจุงุฑ ฺฉ ฺฉุฏ ูุง ูุซูุง src ุฑุง ุชุบุฑ ุฏููุ ุฏูุจุงุฑู npm install ุงุฌุฑุง ู ุดูุฏ.

ุจุฑุง ุญุฐู ฺฉ image ุฎุงุต ู ุชูุงู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ:( ุจุฑุง ุจุฏุณุช ุขูุฑุฏู ฺฉุฏ ูุฑ image ูุชูุงู ุงุฒ  docker image ls ุงุณุชูุงุฏู ฺฉุฑุฏ )

docker image rm 26sadf564

ุฏุฑ ูุงูุน ูุง ุจุฑุง ุงูฺฉู ุงูพูพ ูุงู ุงุฒ ุฏูุง ุจุฑูู ูู ุจู ุขู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดู ( ูุซูุง ุจูู ุณุณุชู ูุง ฺฉู ุจู ุงูุชุฑูุช ูุง ูุชุตู ูุณุชูุฏ ) ุขู ุฑุง ุจุจููุฏ ุจุงุฏ ุจุฑุง ุขู ูพูุฑุช ุชุนู ุดูุฏ ู ูุดุฎุต ุดูุฏ ฺฉู ฺ ูพูุฑุช ุงุฒ ุฏูุง ุฏุงุฎู ุฏุงฺฉุฑ ุจุงุฏ ุงุทูุงุนุงุช ุฑุง ุจู ฺ ูพูุฑุช ุงุฒ ุฏูุง ุจุฑูู ุจูุฑุณุชุฏ.

ุจุฑุง ุงูฺฉู ฺฉ ฺฉุงูุชูุฑ ุฑุง ุจุจูู ุงุฒ ุฏุณุชูุฑ docker ps ู ุจุฑุง ูุชููู ฺฉุฑุฏู ู ุญุฐู ฺฉ ฺฉุงูุชูุฑ ฺฉ ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช ุงุฒ ุฏุณุชูุฑ docker rm react-app -f ุงุณุชูุงุฏู ู ฺฉูู

ููุดู ุนุฏุฏ ุณูุช ุฑุงุณุช : ุนุฏุฏ ุงุณุช ฺฉ ูุฑุจูุท ุจู ุฎูุฏ docker ู ุจุงุดุฏ ู ุนุฏุฏ ุณูุช ฺูพ : ููุดู ูุฑุจูุท ุจู ููฺฉุงู ูุงุดู ูุง ู ุจุงุดุฏุ ูุซู ููุฏูุฒ ู ุณุณุชู ูุง ฺฉ ุจู ุงูุชุฑูุช ูุง ูุชุตู ูุณุชูุฏ. ุนู ูุซูุง ูุฑฺฉุณ ุฏุฑ ุงูุชุฑูุช ูู ( local machine ) ุจุง 3010 ูุชูุงูุฏ ุงุทูุงุนุงุช ุจูุฑุณุชุฏ ุง ุจฺฏุฑุฏ ู ุฏุงฺฉุฑ ูู ุงู ุฏุฑุฎูุงุณุช ูุง ุฑุง ุจู ุฏุฑฺฏุงู 3000 ุงูุชูุงู ู ุฏูุฏ ฺฉ ุฏุฑ ุงู ูุซุงูุ react ูุจุงุดุฏ.

ุฏุณุชูุฑ docker exec -it react-app bash ุฏุฑ ูุงูุน ูุญุท bash ุฑุง ุฏุฑ ฺฉุงูุชูุฑ ูุฑุจูุทู ุจุงุฒ ู ฺฉูุฏ.


### nginx and docker-compose

๐ ู ุชูุงู ุชูุณุท ฺฉุงููฺฏ ุฒุฑ ุฏุฑ docker-compose ุงุฒ 2 ุณุฑูุณ ูุฌุฒุง ูุงููุฏ node ู nginx ููุฒูุงู ุจุฑุง ฺฉ ฺฉุงูุชูุฑ ุฎุงุต ุงุณุชูุงุฏู ฺฉุฑุฏ:

<div dir="ltr">

```docker-compose
    version: "3"
    services:
        hdreact:
            build:
                context: .
            volumes:
                - .:/hami-dashboard
            ports:
                - 8081:8081
            image: hdreact:react
            container_name: hami-dashboard
            stdin_open: true
            # environment:
            #     SERVICE_NAME: node
            #     SERVICE_TAGS: react
            # command: npm start
            environment:
                NODE_ENV: production
            restart: unless-stopped

        #Nginx Service
        webserver:
        image: nginx:alpine
        container_name: nginx
        restart: unless-stopped
        tty: true
        ports:
            - "4000:8081"
            #  - "443:443"
            #  - "9001-9009:9001-9009"
        volumes:
            - ./:/var/www
            - ./nginx/conf.d/:/etc/nginx/conf.d/
        # networks:
        # - app-network
```

</div>

๐ ููฺูู ู ุชูุงู ุงุฒ ฺฉุงููฺฏ dockerFile ุฒุฑ ูุฒ ุงุณุชูุงุฏู ฺฉุฑุฏ ุจุฑุง ูฺ ฺฉุฑุฏู ุขู ุจุง docker-compose ู ููฺูู ุจุฎุด **stage 2** ูุฒ ู ุชูุงู ุจุฑุง nginx ุฏุฑ ุฏุงฺฉุฑูุงู ุงุณุชูุงุฏู ฺฉุฑุฏ ฺฉ ฺฉุงููุช ู ุจุงุดุฏุ ุงูุง ุจูุชุฑ ุงุณุช ฺฉ ุฏุฑ docker-compose ุจุงุดุฏ.

<div dir="ltr">

```dockerFile
    # stage1 - build react app first
    FROM node:14.17.3-alpine3.14 as build
    WORKDIR /hami-dashboard
    ENV PATH=/node_modules/.bin:$PATH
    COPY package.json ./
    RUN npm install
    RUN npm rebuild node-sass
    COPY . ./
    # RUN npm run build
    # CMD [ "npm", "run", "build" ]
    #COPY build ./

    # stage 2 - build the final image and copy the react build files
    # FROM nginx:1.17.8-alpine
    # # COPY --from=build /hami-dashboard/build /usr/share/nginx/html
    # COPY --from=build /hami-dashboard/build /var/www/
    # # COPYโ--from=build /hami-dashboard/nginx/nginx.conf /etc/nginx/conf.d/default.conf
    # RUN rm /etc/nginx/conf.d/default.conf
    # COPY nginx/nginx.conf /etc/nginx/conf.d
    # CMD ["nginx", "-g", "daemon off;"]
    EXPOSE 8081
```

</div>

